<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Retrofit Existing NS - LoopDocs</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <link href="../../stylesheets/admonitions.css" rel="stylesheet">
        <link href="../../stylesheets/extra.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">LoopDocs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Build App <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../build/overview/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../build/step1/" class="dropdown-item">Step 1 Compatible Computer</a>
</li>
                                    
<li>
    <a href="../../build/step2/" class="dropdown-item">Step 2 Compatible iPhone/iPod touch</a>
</li>
                                    
<li>
    <a href="../../build/step3/" class="dropdown-item">Step 3 Compatible Pump</a>
</li>
                                    
<li>
    <a href="../../build/step4/" class="dropdown-item">Step 4 Compatible CGM</a>
</li>
                                    
<li>
    <a href="../../build/step5/" class="dropdown-item">Step 5 Order a Radio-Link</a>
</li>
                                    
<li>
    <a href="../../build/step6/" class="dropdown-item">Step 6 Enroll in Apple Developer Program</a>
</li>
                                    
<li>
    <a href="../../build/step8/" class="dropdown-item">Step 8 Download Xcode</a>
</li>
                                    
<li>
    <a href="../../build/step9/" class="dropdown-item">Step 9 Xcode Preferences</a>
</li>
                                    
<li>
    <a href="../../build/step10/" class="dropdown-item">Step 10 Test Settings</a>
</li>
                                    
<li>
    <a href="../../build/step11/" class="dropdown-item">Step 11 Make plans for Loop Data</a>
</li>
                                    
<li>
    <a href="../../build/step12/" class="dropdown-item">Step 12 Meet Community</a>
</li>
                                    
<li>
    <a href="../../build/step13/" class="dropdown-item">Step 13 Download Loop code</a>
</li>
                                    
<li>
    <a href="../../build/step14/" class="dropdown-item">Step 14 Build Loop app</a>
</li>
                                    
<li>
    <a href="../../build/build_errors/" class="dropdown-item">Oh dear! Build errors?</a>
</li>
                                    
<li>
    <a href="../../build/code_customization/" class="dropdown-item">Customize your Loop</a>
</li>
                                    
<li>
    <a href="../../build/updating/" class="dropdown-item">Updating/Rebuilding your Loop</a>
</li>
                                    
<li>
    <a href="../../build/loopworkspace/" class="dropdown-item">LoopWorkspace</a>
</li>
                                    
<li>
    <a href="../../build/step7/" class="dropdown-item">Step 7 Skip Step 7</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Set up App <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../operation/overview/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../build/health/" class="dropdown-item">Step 1: Health Permissions</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Step 2: Add Pump</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../operation/loop-settings/mdt-pump/" class="dropdown-item">Add Medtronic</a>
</li>
            
<li>
    <a href="../../operation/loop-settings/omnipod-pump/" class="dropdown-item">Add Omnipod</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../operation/loop-settings/cgm/" class="dropdown-item">Step 3: Add CGM</a>
</li>
                                    
<li>
    <a href="../../operation/loop-settings/configurations/" class="dropdown-item">Step 4: Configurations</a>
</li>
                                    
<li>
    <a href="../../operation/loop-settings/services/" class="dropdown-item">Step 5: Loop Services</a>
</li>
                                    
<li>
    <a href="../../operation/loop-settings/displays/" class="dropdown-item">Loop Displays</a>
</li>
                                    
<li>
    <a href="../../operation/loop-settings/rileylink/" class="dropdown-item">RileyLink menu</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Operate <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../operation/features/carbs/" class="dropdown-item">Meal Entries</a>
</li>
                                    
<li>
    <a href="../../operation/features/bolus/" class="dropdown-item">Bolus</a>
</li>
                                    
<li>
    <a href="../../operation/features/workout/" class="dropdown-item">Overrides</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">How to Use Loop App</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../operation/features/premeal/" class="dropdown-item">Pre-meal target</a>
</li>
            
<li>
    <a href="../../operation/features/healthapp/" class="dropdown-item">Health app</a>
</li>
            
<li>
    <a href="../../operation/features/ice/" class="dropdown-item">Using ICE info</a>
</li>
            
<li>
    <a href="../../operation/features/watch/" class="dropdown-item">Apple Watch</a>
</li>
            
<li>
    <a href="../../operation/features/widget/" class="dropdown-item">iPhone widget</a>
</li>
            
<li>
    <a href="../../operation/features/notifications/" class="dropdown-item">Loop Notifications</a>
</li>
            
<li>
    <a href="../../operation/features/battery/" class="dropdown-item">Pump Battery</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Looping Tips</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../operation/loop/open-loop/" class="dropdown-item">Open Loop</a>
</li>
            
<li>
    <a href="../../operation/loop/close-loop/" class="dropdown-item">Closed Loop</a>
</li>
            
<li>
    <a href="../../operation/loop/looptips/" class="dropdown-item">Loop Tips</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Algorithm</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../operation/algorithm/overview/" class="dropdown-item">Overview</a>
</li>
            
<li>
    <a href="../../operation/algorithm/bolus/" class="dropdown-item">Bolus Recommendations</a>
</li>
            
<li>
    <a href="../../operation/algorithm/prediction/" class="dropdown-item">Glucose Prediction</a>
</li>
            
<li>
    <a href="../../operation/algorithm/temp-basal/" class="dropdown-item">Temp Basal Adjustments</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Troubleshoot</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../troubleshooting/overview/" class="dropdown-item">Overview</a>
</li>
            
<li>
    <a href="../../troubleshooting/loop-crashing/" class="dropdown-item">Loop App crashes</a>
</li>
            
<li>
    <a href="../../troubleshooting/yellow-red-loop/" class="dropdown-item">Red Loop</a>
</li>
            
<li>
    <a href="../../troubleshooting/pod-pairing/" class="dropdown-item">Pod Pairing Failures</a>
</li>
            
<li>
    <a href="../../troubleshooting/uncertain-bolus/" class="dropdown-item">Pod Uncertain Boluses</a>
</li>
            
<li>
    <a href="../../troubleshooting/priming/" class="dropdown-item">MDT Priming and Sites</a>
</li>
            
<li>
    <a href="../../troubleshooting/time-change/" class="dropdown-item">Time Changes</a>
</li>
            
<li>
    <a href="../../troubleshooting/pump-errors/" class="dropdown-item">MDT Pump Errors</a>
</li>
            
<li>
    <a href="../../troubleshooting/omnipod-faults/" class="dropdown-item">Omnipod Faults</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Nightscout <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../overview/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../new_user/" class="dropdown-item">Brand New NS</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Retrofit Existing NS</a>
</li>
                                    
<li>
    <a href="../troublehoot/" class="dropdown-item">Setup Troubleshooting</a>
</li>
                                    
<li>
    <a href="../remote-overrides/" class="dropdown-item">Remote Overrides</a>
</li>
                                    
<li>
    <a href="../ifttt/" class="dropdown-item">IFTTT</a>
</li>
                                    
<li>
    <a href="../pebble/" class="dropdown-item">Pebble</a>
</li>
                                    
<li>
    <a href="../pushover/" class="dropdown-item">Remote Notifications</a>
</li>
                                    
<li>
    <a href="../reports/" class="dropdown-item">Reports</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">FAQs <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../faqs/docs-faqs/" class="dropdown-item">Using This Site FAQs</a>
</li>
                                    
<li>
    <a href="../../faqs/FAQs/" class="dropdown-item">General Loop FAQs</a>
</li>
                                    
<li>
    <a href="../../faqs/omnipod-faqs/" class="dropdown-item">Omnipod FAQs</a>
</li>
                                    
<li>
    <a href="../../faqs/branch-faqs/" class="dropdown-item">Branch FAQs</a>
</li>
                                    
<li>
    <a href="../../faqs/update-faqs/" class="dropdown-item">Update/Rebuild Loop FAQs</a>
</li>
                                    
<li>
    <a href="../../faqs/ios13/" class="dropdown-item">iOS 13 FAQs</a>
</li>
                                    
<li>
    <a href="../../faqs/rileylink-faqs/" class="dropdown-item">Radio-link FAQs</a>
</li>
                                    
<li>
    <a href="../../faqs/algorithm-faqs/" class="dropdown-item">Algorithm FAQs</a>
</li>
                                    
<li>
    <a href="../../faqs/cgm-faqs/" class="dropdown-item">CGM FAQs</a>
</li>
                                    
<li>
    <a href="../../faqs/safety-faqs/" class="dropdown-item">Safety Tips</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../new_user/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../troublehoot/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#adding-loop-to-existing-ns" class="nav-link">Adding Loop to Existing NS</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#new-variables-for-loopers" class="nav-link">New Variables for Loopers</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#nightscout-version-update" class="nav-link">Nightscout Version Update</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="adding-loop-to-existing-ns">Adding Loop to Existing NS<a class="headerlink" href="#adding-loop-to-existing-ns" title="Permanent link">⌁</a></h1>
<p>Many people may already have an existing Nightscout site setup from before adding Loop to their management strategies. In order to make the most of your Looping setup, you will need to modify your existing Nightscout site a bit specifically for Loop. The process is pretty easy and should not take long.</p>
<h2 id="new-variables-for-loopers">New Variables for Loopers<a class="headerlink" href="#new-variables-for-loopers" title="Permanent link">⌁</a></h2>
<p>The modifications for retrofitting an existing NS site for new Loop users will require you to make some edits to your Heroku site.  There are five steps:</p>
<ol>
<li>Login to Heroku, Open Settings Tab</li>
<li>Edit/Add Config Vars</li>
<li>Open Nightscout Site</li>
<li>Turn on Plugins</li>
<li>Update Profile Settings</li>
</ol>
<h3 id="step-1-login-to-heroku-settings-tab">Step 1: Login to Heroku, Settings Tab<a class="headerlink" href="#step-1-login-to-heroku-settings-tab" title="Permanent link">⌁</a></h3>
<p><a href="https://id.heroku.com/login">Login to your Heroku account</a>, select the <code>Settings</code> tab near the top of the screen on your Heroku app.</p>
<p align="center"><img alt="img/heroku5.png" src="../img/heroku5.png" width="600" /></p>
<h3 id="step-2-editadd-config-vars">Step 2: Edit/Add Config Vars<a class="headerlink" href="#step-2-editadd-config-vars" title="Permanent link">⌁</a></h3>
<p>Click on <code>Reveal Config Vars</code>.  Scroll down the bottom of the Config Vars lines until you find the last blank one.  You are going to add several additional lines of config vars for Loop use; the DEVICESTATUS_ADVANCED and ENABLE lines are required, the others just make Nightscout more useful when Looping.</p>
<p align="center"><img alt="img/add_vars.jpg" src="../img/add_vars.jpg" width="600" /></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>ENABLE</th>
<td>bridge loop pump iob cob basal careportal sage cage bage override dbsize</br></br>
<b>(Note: If you are an existing NS user, you likely already have an ENABLE line in this section of Heroku. Don't add a new one. Simply find the existing ENABLE line, click on the little pencil icon to the right of it, and add the words shown on the ENABLE line above to the existing words already on the enable line.  Avoid duplicates. The remainder of the lines are likely going to be brand new additions to your Heroku settings.)</b></td>
</tr>
<tr>
<th>DEVICESTATUS_ADVANCED</th>
<td>true</td>
</tr>
<tr>
<th>PUMP_FIELDS</th>
<td>battery reservoir clock status</td>
</tr>
<tr>
<th>PUMP_RETRO_FIELDS</th>
<td>battery reservoir clock status</td>
</tr>
<tr>
<th>SHOW_FORECAST</th>
<td>loop</td>
</tr>
<tr>
<th>SHOW_PLUGINS</th>
<td>loop pump cob iob sage cage careportal basal override dbsize</td>
</tr>
<tr>
<th>PUMP_ENABLE_ALERTS</th>
<td>true</td>
</tr>
<tr>
<th>PUMP_URGENT_BATT_U</th>
<td>30</br></br>(This is the pump battery percentage that will trigger a red, urgent alert in NS.)</td>
</tr>
<tr>
<th>PUMP_URGENT_BATT_V</th>
<td>1.25</br></br>(This is the pump battery voltage that will trigger a red, urgent alert in NS.)</td>
</tr>
<tr>
<th>PUMP_URGENT_RES</th>
<td>10</br></br>(This is the reservoir volume that will trigger a red, urgent alert in NS.)</td>
</tr>
<tr>
<th>PUMP_URGENT_CLOCK</th>
<td>30</td>
</tr>
<tr>
<th>LOOP_ENABLE_ALERTS</th>
<td>true</td>
</tr>
<tr>
<th>LOOP_WARN</th>
<td>20</br></br>(This is the minutes since Loop last successfully looped, the t1d will have a similar notification at this time through the Loop app.  This will be a yellow alert in NS.)</td>
</tr>
<tr>
<th>LOOP_URGENT</th>
<td>60</br></br>(Same as the alert above, but will be red in color and have a shorter snooze option.)</td>
</tr>
<tr>
<th>BASAL_RENDER</th>
<td>default</td>
</tr>
</tbody>
</table>

<h3 id="step-3-open-your-ns-site">Step 3: Open Your NS Site<a class="headerlink" href="#step-3-open-your-ns-site" title="Permanent link">⌁</a></h3>
<p>Click on <code>Open App</code> in the top right corner of your Heroku site.</p>
<p align="center"><img alt="img/open_app.jpg" src="../img/open_app.jpg" width="600" /></p>
<h3 id="step-4-turn-on-plugins">Step 4: Turn on Plugins<a class="headerlink" href="#step-4-turn-on-plugins" title="Permanent link">⌁</a></h3>
<p>Click on the settings (those three horizontal lines in the upper right corner).  Now check that your basal render is selected to either default or icicle (personal preference for how the temp basals show as blue lines in NS site), check the boxes that you’d like display pills in the SHOW PLUGINS (usually all of them), and then click save. If you have not authenticated your site previously, you may be prompted to provide your API Secret prior to Nightscout saving your changes.</p>
<p align="center"><img alt="img/settings_ns.jpg" src="../img/settings_ns.jpg" width="600" /></p>
<h3 id="step-5-update-profile-settings">Step 5: Update Profile Settings<a class="headerlink" href="#step-5-update-profile-settings" title="Permanent link">⌁</a></h3>
<p>Double-check that your NS Profile settings are current and that you have a basal profile entered, if you want to see the temp basals that Loop is setting. The values in your Nightscout Profile settings will not impact or affect your Loop, but it is just nice to have them match up in the event you are looking at your data with an endocrinologist or retrospectively looking at data.</p>
<h2 id="nightscout-version-update">Nightscout Version Update<a class="headerlink" href="#nightscout-version-update" title="Permanent link">⌁</a></h2>
<p>If you are new to Loop and haven’t updated your Nightscout site for a while, check to see if there's an available update. Visit <a href="http://nightscout.github.io/update/update/">The Nightscout Update Instructions</a> for directions on updating.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
